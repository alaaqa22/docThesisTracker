<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets">

<f:view>
    <f:metadata>
        <f:viewAction action="#{profileBacking.load()}"/>
        <f:viewParam name="id" value="#{profileBacking.user.id}"/>
    </f:metadata>

    <h:head>
        <title>Profile</title>
        <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" rel="stylesheet"/>
    </h:head>

    <h:body>
        <ui:composition template="../anonymous/template.xhtml">
            <ui:define name="mainContent">
                <div class="container">
                    <h:form>

                        <h3>Profile</h3>


                        <div class="form-group">
                            <label for="firstName-itxt">First Name:</label>
                            <h:inputText id="firstName-itxt" value="#{profileBacking.user.firstName}"
                                         class="form-control"/>
                        </div>

                        <div class="form-group">
                            <label for="lastName-itxt">Last Name:</label>
                            <h:inputText id="lastName-itxt" value="#{profileBacking.user.lastName}"
                                         class="form-control"/>
                        </div>

                        <div class="form-group">
                            <label for="email-itxt">Email:</label>
                            <h:inputText id="email-itxt" value="#{profileBacking.newEmail}" class="form-control">
                                <f:validator validatorId="EmailAddressAvailabilityValidator"/>
                                <f:validator validatorId="EmailAddressSyntaxValidator"/>
                            </h:inputText>
                        </div>

                        <div class="form-group">
                            <label for="password-iscrt">Password:</label>
                            <h:inputSecret id="password-iscrt" value="#{profileBacking.user.password}"
                                           validator="PasswordValidator" class="form-control"/>
                        </div>


                        <div class="form-group">
                            <label for="birthDate-itxt">Birth Date:</label>
                            <h:inputText id="birthDate-itxt" type="localdate" value="#{profileBacking.user.birthDate}"
                                         class="form-control">
                                <f:convertDateTime type="localDate"/>
                            </h:inputText>
                            <h:message for="birthDate-itxt" styleClass="message"/>
                        </div>

                        <!--set user state select one menu -->

                        <div>
                            <h:outputLabel for="user-states-slcom" value="Set user state: "
                                           rendered="#{sessionInfo.deanery or sessionInfo.admin}"/>

                            <h:selectOneMenu id="user-states-slcom" value="#{profileBacking.currentUserState}"
                                             rendered="#{sessionInfo.deanery or sessionInfo.admin}">
                                <f:selectItems value="#{profileBacking.userStates}" var="state"
                                               itemValue="#{state}"/>
                            </h:selectOneMenu>
                        </div>

                        <!--save button -->

                        <h:commandButton id="save-cbtn" value="Save" action="#{profileBacking.save()}"
                                         class="btn btn-primary"/>

                        <!--delete button -->

                        <h:commandButton id="delete-cbtn" value="Delete" action="#{profileBacking.deleteProfile()}"
                                         class="btn btn-danger"/>

                    </h:form>
                </div>
            </ui:define>
        </ui:composition>
    </h:body>
</f:view>

</html>
